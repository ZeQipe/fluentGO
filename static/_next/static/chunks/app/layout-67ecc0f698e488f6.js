(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1256:(e,r,n)=>{"use strict";let t;n.d(r,{MainProvider:()=>S});var o=n(95155),s=n(74852),i=n(34049),l=n(99776);function a(){return new s.E({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchInterval:!1,retry:!1},mutations:{retry:!1}}})}let u=e=>{let{children:r}=e,n=i.S$?a():(t||(t=a()),t);return(0,o.jsx)(l.Ht,{client:n,children:r})};var c=n(73136),d=n(59698);let h=e=>{let{children:r}=e;return(0,o.jsx)(c.F,{features:d.l,children:r})};var v=n(12115),m=n(55863),P=n(80549),g=n(25333),b=n(1685),f=n(14828);let p=()=>{var e;let r=null==(e=document.cookie.split("; ").find(e=>e.startsWith("googtrans=")))?void 0:e.split("=")[1];return r&&r.split("/")[2]||null},j=e=>{let{children:r}=e,{data:n,isSuccess:t}=(0,m.C)(),s=(()=>{let e=(0,l.jE)();return(0,P.n)({mutationFn:async e=>await g.FH.put(b.J.language,{json:e}).json(),onSuccess:r=>{e.setQueryData([f.h.getLanguage],r),console.log("Language synced with server: ".concat(r.language))},onError:e=>{console.error("Ошибка при обновлении языка:",e)}})})(),i=(0,v.useRef)(null);return(0,v.useEffect)(()=>{t&&(null==n?void 0:n.language)&&(p()!==n.language&&((e=>{let r="/".concat("en","/").concat(e);document.cookie="googtrans=".concat(r,"; path=/; max-age=31536000; SameSite=lax");let n=window.location.hostname;document.cookie="googtrans=".concat(r,"; path=/; max-age=31536000; domain=").concat(n,"; SameSite=lax")})(n.language),console.log("Language cookie set from server: ".concat(n.language))),i.current=n.language)},[t,n]),(0,v.useEffect)(()=>{let e=setInterval(()=>{let e=p();e&&i.current&&e!==i.current&&(console.log("Language changed by user: ".concat(i.current," -> ").concat(e)),s.mutate({language:e}),i.current=e)},300);return()=>clearInterval(e)},[s]),(0,o.jsx)(o.Fragment,{children:r})};var x=n(68513),y=n(66171);let k=(0,v.createContext)({isAuthChecked:!1}),A=e=>{let{children:r}=e,{data:n,isSuccess:t,isError:s,error:i,isFetched:l}=(0,x.GB)(),{setAuthData:a}=(0,y.MY)(),{clearUserData:u}=(0,y.mj)();return(0,v.useEffect)(()=>{t&&n&&(console.log("\uD83D\uDFE2 [AuthProvider] Check auth response:",n),"authorized"===n.status?(console.log("✅ [AuthProvider] User authorized:",n.user),n.user&&a({status:"success",message:n.message,user:n.user})):"unauthorized"===n.status?n.user?console.log("\uD83D\uDC64 [AuthProvider] Guest user:",n.user):(console.log("❌ [AuthProvider] User not authorized, clearing data"),u()):"error"===n.status&&console.error("❌ [AuthProvider] Auth check error:",n.message)),s&&console.error("❌ [AuthProvider] Request failed:",i)},[t,s,n,i,a,u]),(0,o.jsx)(k.Provider,{value:{isAuthChecked:l},children:r})};var E=n(22663),w=n(32280),O=n(98959),C=n(41174);let F=e=>{let{children:r}=e,n=(0,l.jE)(),t=(0,v.useRef)(!1),s=O.O.get(),i=(null==s?void 0:s.paymentId)||null,{data:a,isSuccess:u}=(0,w.QD)(i,!!i);return(0,v.useEffect)(()=>{if(!u||!a||t.current)return;let e=a.status;"success"===e?(E.Ay.success("Оплата прошла успешно! \uD83C\uDF89",{duration:5e3,position:"top-center"}),n.invalidateQueries({queryKey:[x.a$.checkAuth]}),n.invalidateQueries({queryKey:[C.U.getTariffs]}),O.O.remove(),t.current=!0):"closed"===e?(E.Ay.error("Не удалось провести оплату. Попробуйте снова.",{duration:5e3,position:"top-center"}),O.O.remove(),t.current=!0):"await"===e&&console.log("Payment status: awaiting...")},[u,a,n]),(0,o.jsx)(o.Fragment,{children:r})},S=e=>{let{children:r}=e;return(0,o.jsx)(h,{children:(0,o.jsx)(u,{children:(0,o.jsx)(A,{children:(0,o.jsx)(j,{children:(0,o.jsx)(F,{children:r})})})})})}},55032:()=>{},60322:(e,r,n)=>{Promise.resolve().then(n.t.bind(n,52619,23)),Promise.resolve().then(n.t.bind(n,22430,23)),Promise.resolve().then(n.bind(n,22663)),Promise.resolve().then(n.bind(n,1256)),Promise.resolve().then(n.t.bind(n,54971,23)),Promise.resolve().then(n.t.bind(n,55032,23)),Promise.resolve().then(n.bind(n,4810)),Promise.resolve().then(n.t.bind(n,39743,23)),Promise.resolve().then(n.bind(n,93034)),Promise.resolve().then(n.t.bind(n,24489,23)),Promise.resolve().then(n.bind(n,38402)),Promise.resolve().then(n.bind(n,83876)),Promise.resolve().then(n.t.bind(n,891,23)),Promise.resolve().then(n.t.bind(n,7133,23)),Promise.resolve().then(n.bind(n,45224)),Promise.resolve().then(n.bind(n,47810)),Promise.resolve().then(n.t.bind(n,7891,23)),Promise.resolve().then(n.bind(n,71981)),Promise.resolve().then(n.bind(n,89228)),Promise.resolve().then(n.bind(n,96018)),Promise.resolve().then(n.bind(n,92242)),Promise.resolve().then(n.bind(n,57602)),Promise.resolve().then(n.bind(n,51264)),Promise.resolve().then(n.bind(n,56388)),Promise.resolve().then(n.bind(n,99534)),Promise.resolve().then(n.bind(n,53962)),Promise.resolve().then(n.bind(n,55302)),Promise.resolve().then(n.t.bind(n,23958,23)),Promise.resolve().then(n.bind(n,67693)),Promise.resolve().then(n.bind(n,84155)),Promise.resolve().then(n.bind(n,91562)),Promise.resolve().then(n.bind(n,55637)),Promise.resolve().then(n.bind(n,87721)),Promise.resolve().then(n.bind(n,40933)),Promise.resolve().then(n.bind(n,59877)),Promise.resolve().then(n.bind(n,49051)),Promise.resolve().then(n.bind(n,41534)),Promise.resolve().then(n.bind(n,42135)),Promise.resolve().then(n.bind(n,3785)),Promise.resolve().then(n.t.bind(n,31298,23)),Promise.resolve().then(n.bind(n,74443)),Promise.resolve().then(n.bind(n,49478)),Promise.resolve().then(n.bind(n,36497))}},e=>{e.O(0,[736,916,954,862,616,578,189,51,441,255,358],()=>e(e.s=60322)),_N_E=e.O()}]);