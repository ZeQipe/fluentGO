"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{9034:(e,t,a)=>{a.r(t),a.d(t,{LanguageProvider:()=>v});var n=a(95155),r=a(12115),o=a(55863),c=a(99776),l=a(80549),u=a(25333),g=a(1685),s=a(14828),i=a(41174),f=a(20063),d=a(52321);let m=()=>{var e;let t=null==(e=document.cookie.split("; ").find(e=>e.startsWith("googtrans=")))?void 0:e.split("=")[1];return t&&t.split("/")[2]||"en"},h=e=>{if(!window)return;let t="/".concat("en","/").concat(e);document.cookie="googtrans=".concat(t,"; path=/; max-age=31536000; SameSite=lax");let a=window.location.hostname;document.cookie="googtrans=".concat(t,"; path=/; max-age=31536000; domain=").concat(a,"; SameSite=lax")},v=e=>{let{children:t}=e,{data:a,isSuccess:v}=(0,o.C)(),p=(0,c.jE)(),k=(0,f.usePathname)(),w=(0,f.useRouter)(),E=(0,f.useSearchParams)(),S=(()=>{let e=(0,c.jE)();return(0,l.n)({mutationFn:async e=>await u.FH.put(g.J.language,{json:e}).json(),onSuccess:t=>{e.setQueryData([s.h.getLanguage],t),console.log("Language synced with server: ".concat(t.language))},onError:e=>{console.error("Ошибка при обновлении языка:",e)}})})(),j=(0,r.useRef)(null),x=(0,r.useRef)(!1),y=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=E.get("locale");if(!t&&a===e)return;let n=E.toString(),r=n?"".concat(k,"?").concat(n):k,o=(0,d.c)(r,e);w.replace(o,{scroll:!1})},[k,E,w]);return(0,r.useEffect)(()=>{if(!x.current){let e=E.get("locale");e?m()!==e&&h(e):y(m(),!0),j.current=e||m(),x.current=!0}},[k,E,w,y]),(0,r.useEffect)(()=>{if(v&&(null==a?void 0:a.language)&&x.current){let e=m(),t=(0,d.o)(E);e!==a.language&&(h(a.language),console.log("Language cookie set from server: ".concat(a.language))),t!==a.language&&y(a.language,!0),j.current=a.language}},[v,a,k,E,w,y]),(0,r.useEffect)(()=>{if(!x.current)return;let e=setInterval(()=>{let e=m();null!==j.current&&e!==j.current&&(console.log("Language changed from ".concat(j.current," to ").concat(e)),j.current=e,S.mutate({language:e},{onSuccess:()=>{console.log("Invalidating tariffs cache"),p.invalidateQueries({queryKey:[i.U.getTariffs]})}}),setTimeout(()=>{y(e,!0)},500))},300);return()=>clearInterval(e)},[S,p,w,k,E,y]),(0,n.jsx)(n.Fragment,{children:t})}}}]);