# Инструкция по редактированию тарифов (tariffs.json)

## Введение

Файл `tariffs.json` содержит все тарифные планы, которые отображаются пользователям на сайте. Этот документ объясняет, как добавлять новые тарифы, редактировать существующие или удалять ненужные.

---

## Структура файла

Файл представляет собой массив (список) тарифов, заключенный в квадратные скобки `[ ]`. Каждый тариф — это отдельный блок с параметрами, заключенный в фигурные скобки `{ }`.

```json
[
  {
    "тариф 1": "..."
  },
  {
    "тариф 2": "..."
  }
]
```

**Важно:**
- После каждого блока тарифа ставится запятая `,` кроме последнего
- Все текстовые значения заключаются в двойные кавычки `""`
- Числовые значения и массивы пишутся без кавычек
- Не используйте комментарии в JSON файле (текст после `//` удалите перед сохранением)

---

## Описание полей тарифа

### Обязательные поля

| Поле          | Тип     | Описание                                                          | Пример                        |
|---------------|---------|-------------------------------------------------------------------|-------------------------------|
| `id`          | текст   | Уникальный идентификатор тарифа (латиница, дефисы)               | `"pro-plus"`                  |
| `name`        | текст   | Название тарифа (отображается пользователям)                     | `"Подписка PRO +"`            |
| `price`       | текст   | Цена с символом валюты                                            | `"$14.5"` или `"$0"`          |
| `period`      | текст   | Период тарификации                                                | `"/мес"` или `"/100 мин"`     |
| `statuses`    | массив  | Список статусов, кому доступен тариф                              | `[]` или `["vip", "partner"]` |
| `features`    | массив  | Список возможностей тарифа                                        | См. раздел "Возможности"      |
| `tariff`      | текст   | Технический идентификатор (совпадает с `id` или упрощенный)       | `"pro-plus"`                  |
| `buttonText`  | текст   | Текст на кнопке (будет динамически изменяться)                    | `"Начать"`                    |
| `buttonType`  | текст   | Тип кнопки: `"standard"` или `"secondary"`                        | `"secondary"`                 |
| `disabled`    | boolean | Доступна ли кнопка: `true` (недоступна) или `false` (доступна)    | `false`                       |

---

## Поле "statuses" (Ограничение доступа)

Это поле определяет, **кому будет виден тариф** на основе статуса пользователя.

### Правила:

1. **Пустой массив `[]`** — тариф доступен **всем пользователям** без исключения
   ```json
   "statuses": []
   ```

2. **Массив со статусами** — тариф доступен **только указанным статусам**
   ```json
   "statuses": ["vip", "partner"]
   ```
   Этот тариф увидят только пользователи со статусом `vip` или `partner`.

3. **Специальное значение `"all"`** — тариф доступен всем
   ```json
   "statuses": ["all"]
   ```

### Доступные статусы пользователей:

- `user` — обычный пользователь (по умолчанию)
- `vip` — VIP пользователь
- `partner` — партнер
- `admin` — администратор
- `moderator` — модератор
- `cmo` — корпоративный клиент (CMO)
- `ceo` — топ-менеджмент
- И другие кастомные статусы по необходимости

**Примеры:**

```json
// Тариф для всех
"statuses": []

// Тариф только для VIP
"statuses": ["vip"]

// Тариф для VIP и партнеров
"statuses": ["vip", "partner"]

// Тариф для корпоративных клиентов
"statuses": ["cmo", "ceo", "admin"]
```

---

## Поле "features" (Возможности тарифа)

Массив возможностей, которые включены в тариф. Каждая возможность — это объект с двумя полями:

```json
"features": [
  {
    "text": "Описание возможности",
    "included": true
  },
  {
    "text": "Другая возможность",
    "included": true
  }
]
```

| Поле       | Тип     | Описание                                                 |
|------------|---------|----------------------------------------------------------|
| `text`     | текст   | Описание возможности (что получит пользователь)          |
| `included` | boolean | Включена ли возможность: `true` (да) или `false` (нет)   |

**Примечание:** Обычно используется только `"included": true`. Поле `false` можно использовать для показа, что возможность НЕ включена в данный тариф.

---

## Как добавить новый тариф

### Шаг 1: Определите позицию

Решите, в каком месте списка будет новый тариф. Обычно тарифы идут по возрастанию цены:
1. Free
2. Pay-as-you-go
3. Standart
4. Pro
5. Pro+ (эксклюзивный)

### Шаг 2: Скопируйте шаблон

```json
{
  "id": "уникальный-идентификатор",
  "name": "Название тарифа",
  "price": "$0",
  "period": "/мес",
  "statuses": [],
  "features": [
    {
      "text": "Описание возможности 1",
      "included": true
    },
    {
      "text": "Описание возможности 2",
      "included": true
    }
  ],
  "tariff": "уникальный-идентификатор",
  "buttonText": "Начать",
  "buttonType": "secondary",
  "disabled": false
}
```

### Шаг 3: Заполните поля

1. **id** и **tariff**: придумайте уникальное имя (латиница, дефисы). Пример: `"enterprise-plan"`
2. **name**: красивое название. Пример: `"Корпоративный план"`
3. **price**: цена. Пример: `"$99"` или `"$0"`
4. **period**: период. Пример: `"/мес"`, `"/год"`, `"/100 мин"`
5. **statuses**: укажите кому доступен:
   - `[]` — всем
   - `["vip"]` — только VIP
   - `["cmo", "ceo"]` — только корпоративным клиентам
6. **features**: перечислите возможности тарифа
7. **buttonText**: можно оставить `"Начать"` или `"Купить"`
8. **buttonType**: обычно `"secondary"`
9. **disabled**: обычно `false`

### Шаг 4: Вставьте в файл

1. Откройте `tariffs.json`
2. Найдите место для нового тарифа
3. Вставьте блок
4. **Важно:** Поставьте запятую `,` после предыдущего тарифа
5. Сохраните файл

### Пример добавления тарифа для корпоративных клиентов:

```json
[
  {
    "id": "free-guest",
    "name": "Free Guest",
    ...
  },
  {
    "id": "enterprise",
    "name": "Корпоративный",
    "price": "$199",
    "period": "/мес",
    "statuses": ["cmo", "ceo", "enterprise"],
    "features": [
      {
        "text": "Безлимитные разговоры",
        "included": true
      },
      {
        "text": "Персональный менеджер",
        "included": true
      },
      {
        "text": "Корпоративная аналитика",
        "included": true
      },
      {
        "text": "API интеграция",
        "included": true
      }
    ],
    "tariff": "enterprise",
    "buttonText": "Связаться с нами",
    "buttonType": "secondary",
    "disabled": false
  }
]
```

---

## Как редактировать существующий тариф

### Изменить цену:

Найдите нужный тариф по `id` и измените поле `price`:

```json
{
  "id": "pro",
  "price": "$39",  // Было $29, стало $39
  ...
}
```

### Изменить название:

```json
{
  "id": "pro",
  "name": "Подписка PRO Max",  // Было "Подписка PRO"
  ...
}
```

### Добавить/удалить возможность:

#### Добавить возможность:

```json
"features": [
  {
    "text": "Безлимитные разговоры",
    "included": true
  },
  {
    "text": "Новая возможность",  // ДОБАВЛЕНО
    "included": true
  }
]
```

#### Удалить возможность:

Просто удалите весь блок `{ "text": "...", "included": true }` вместе с запятой.

### Изменить доступность по статусам:

```json
// Было: доступен всем
"statuses": []

// Стало: доступен только VIP
"statuses": ["vip"]
```

---

## Как удалить тариф

1. Найдите нужный тариф по `id`
2. Удалите **весь блок** от `{` до `}` включительно
3. Удалите запятую после блока (если она есть)
4. Убедитесь, что после последнего тарифа **нет запятой**
5. Сохраните файл

### Пример:

**До удаления:**
```json
[
  {
    "id": "free-guest",
    ...
  },
  {
    "id": "old-tariff",  // Этот тариф нужно удалить
    ...
  },
  {
    "id": "pro",
    ...
  }
]
```

**После удаления:**
```json
[
  {
    "id": "free-guest",
    ...
  },
  {
    "id": "pro",
    ...
  }
]
```

---

## Частые ошибки

### ❌ Ошибка 1: Лишняя запятая после последнего элемента

```json
[
  {
    "id": "pro",
    ...
  }, // ← Эта запятая лишняя!
]
```

**Правильно:**
```json
[
  {
    "id": "pro",
    ...
  } // ← Без запятой
]
```

---

### ❌ Ошибка 2: Отсутствие запятой между элементами

```json
[
  {
    "id": "free",
    ...
  } // ← Здесь нужна запятая!
  {
    "id": "pro",
    ...
  }
]
```

**Правильно:**
```json
[
  {
    "id": "free",
    ...
  }, // ← С запятой
  {
    "id": "pro",
    ...
  }
]
```

---

### ❌ Ошибка 3: Неправильные кавычки

```json
"name": 'Подписка PRO' // ← Одинарные кавычки НЕВЕРНО
```

**Правильно:**
```json
"name": "Подписка PRO" // ← Двойные кавычки
```

---

### ❌ Ошибка 4: Дублирование id

Каждый `id` должен быть уникальным:

```json
[
  { "id": "pro", ... },
  { "id": "pro", ... } // ← Дубликат!
]
```

---

## Проверка корректности JSON

После редактирования файла проверьте его корректность:

1. **Онлайн валидатор:** https://jsonlint.com/
   - Скопируйте весь текст из файла
   - Вставьте в валидатор
   - Нажмите "Validate JSON"

2. **Визуальная проверка:**
   - Все открывающие `{` и `[` закрыты `}` и `]`
   - Все строки в двойных кавычках `""`
   - Запятые между элементами, но не после последнего
   - Массив `statuses` в квадратных скобках `[]`

---

## Рекомендации

1. **Делайте резервную копию** перед изменениями (скопируйте файл)
2. **Изменяйте по одному полю** за раз для простоты отладки
3. **Используйте текстовый редактор** с подсветкой JSON (VS Code, Notepad++, Sublime Text)
4. **Проверяйте файл** валидатором после каждого изменения
5. **Тестируйте на сайте** после сохранения изменений

---

## Примеры популярных сценариев

### Сценарий 1: Создать скидочный тариф для VIP

```json
{
  "id": "vip-discount",
  "name": "VIP Скидка 50%",
  "price": "$14.5",
  "period": "/мес",
  "statuses": ["vip"],
  "features": [
    {
      "text": "Все возможности PRO",
      "included": true
    },
    {
      "text": "Скидка 50%",
      "included": true
    }
  ],
  "tariff": "vip-discount",
  "buttonText": "Активировать",
  "buttonType": "secondary",
  "disabled": false
}
```

---

### Сценарий 2: Временно скрыть тариф от всех

Вместо удаления тарифа, сделайте его доступным только админам:

```json
{
  "id": "standart",
  "statuses": ["admin"], // Только админы увидят
  ...
}
```

Или установите `disabled: true`:

```json
{
  "id": "standart",
  "disabled": true, // Кнопка будет неактивной
  ...
}
```

---

### Сценарий 3: Изменить цену сезонно

```json
{
  "id": "pro",
  "name": "Подписка PRO (Черная пятница)",
  "price": "$19", // Было $29
  "period": "/мес",
  ...
}
```

После акции верните старые значения.

---

## Контрольный список перед сохранением

- [ ] Все `id` уникальны
- [ ] Поле `statuses` заполнено (`[]` или `["status"]`)
- [ ] Цены указаны с символом валюты (`$`)
- [ ] Все тексты в двойных кавычках
- [ ] Запятые расставлены правильно
- [ ] Файл проверен в JSON валидаторе
- [ ] Сделана резервная копия старой версии

---

## Заключение

Следуя этой инструкции, вы сможете легко управлять тарифами без риска сломать систему. При возникновении ошибок проверьте файл валидатором и сверьтесь с примерами выше.

