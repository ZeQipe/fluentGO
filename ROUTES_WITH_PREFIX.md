# –†–û–£–¢–´ –° –ü–†–ï–§–ò–ö–°–û–ú

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–µ—Ñ–∏–∫—Å–∞

–í —Ñ–∞–π–ª–µ `.env` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:
```env
SERVER_PREFIX=/fluent
```

## üìã –í–°–ï –†–û–£–¢–´ –° –ü–†–ï–§–ò–ö–°–û–ú `/fluent`

### **üîó API –†–æ—É—Ç—ã (`/fluent/api/`)**

#### **üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Å–µ—Å—Å–∏–∏:**
- `GET /fluent/api/session-id` - –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Å–µ—Å—Å–∏–∏ –¥–ª—è WebSocket
- `GET /fluent/api/check-auth` - –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞
- `GET /fluent/api/login` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /fluent/api/logout` - –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã

#### **üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –±–∞–ª–∞–Ω—Å:**
- `GET /fluent/api/test-db` - –¢–µ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `GET /fluent/api/demo-user` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–µ–º–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- `GET /fluent/api/tariffs` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤
- `GET /fluent/api/language` - –ü–æ–ª—É—á–µ–Ω–∏–µ —è–∑—ã–∫–∞
- `PUT /fluent/api/language` - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —è–∑—ã–∫–∞

#### **üéµ –ê—É–¥–∏–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞:**
- `POST /fluent/api/upload-audio/` - –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ (Button Realtime)

#### **üí≥ –ü–ª–∞—Ç–µ–∂–∏:**
- `POST /fluent/api/create-payment` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- `GET /fluent/api/payment-status/{internal_order_id}` - –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞
- `POST /fluent/api/webhook/payment` - Webhook –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π

#### **üìö –¢–µ–º—ã:**
- `POST /fluent/api/topics` - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–º—ã
- `GET /fluent/api/topics` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /fluent/api/topics` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–º—ã
- `DELETE /fluent/api/topics/{topic_id}` - –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–º—ã

#### **‚ùì –°–ø—Ä–∞–≤–∫–∞:**
- `GET /fluent/api/help` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

---

### **üîó CRM –†–æ—É—Ç—ã (`/fluent/crm/`)**

#### **üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:**
- `GET /fluent/crm/api/tariffs` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–ª—è CRM
- `POST /fluent/crm/api/user` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /fluent/crm/api/user/{user_id}/balance` - –ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /fluent/crm/api/user/{user_id}/balance` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
- `PUT /fluent/crm/api/user/{user_id}/status` - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### **üîó WebSocket –†–æ—É—Ç—ã**

#### **üé§ –ì–æ–ª–æ—Å–æ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
- `WS /fluent/ws` - VAD Realtime (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏)
- `WS /fluent/ws-button` - Button Realtime (—Ä—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—å—é)

---

### **üîó –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã**

#### **üìÅ –§—Ä–æ–Ω—Ç–µ–Ω–¥:**
- `GET /fluent/` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `GET /fluent/{full_path:path}` - SPA fallback (–≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏)
- `GET /fluent/_next/*` - Next.js –∞—Å—Å–µ—Ç—ã
- `GET /fluent/assets/*` - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã

---

## **üìä –°–≤–æ–¥–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Ä–æ—É—Ç–æ–≤:**

| **–¢–∏–ø** | **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|---------|----------------|----------------|
| **API GET** | 8 | –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| **API POST** | 6 | –°–æ–∑–¥–∞–Ω–∏–µ/–æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö |
| **API PUT** | 2 | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| **API DELETE** | 1 | –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| **CRM GET** | 2 | CRM –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| **CRM POST** | 1 | CRM —Å–æ–∑–¥–∞–Ω–∏–µ |
| **CRM PUT** | 2 | CRM –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |
| **WebSocket** | 2 | –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è |
| **Static** | 4 | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã |

**–í—Å–µ–≥–æ —Ä–æ—É—Ç–æ–≤: 28**

---

## **üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**

### **1. app.py:**
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `load_dotenv()`
- –ü–æ–ª—É—á–µ–Ω–∏–µ `SERVER_PREFIX` –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –í—Å–µ —Ä–æ—É—Ç–µ—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –º–æ–Ω—Ç–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º
- Fallback —Ä–æ—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º

### **2. env.example:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `SERVER_PREFIX=/fluent`
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ URL –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### **3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã:**
- `VAD_WS_ENDPOINT=wss://your-domain.com/fluent/ws`
- `BUTTON_WS_ENDPOINT=wss://your-domain.com/fluent/ws-button`
- `BUTTON_UPLOAD_ENDPOINT=https://your-domain.com/fluent/api/upload-audio/`
- `WEBHOOK_URL=https://your-domain.com/fluent/api/webhook/payment`
- `PAYMENT_RETURN_URL=https://your-domain.com/fluent/payment/success`
- `NEXT_PUBLIC_UPLOAD_URL=/fluent/api/upload-audio/`

---

## **‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç:**

–¢–µ–ø–µ—Ä—å **–í–°–ï —Ä–æ—É—Ç—ã** –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞ `/fluent` (–∏–ª–∏ –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ `SERVER_PREFIX`).

**–ü—Ä–∏–º–µ—Ä—ã:**
- API: `https://domain.com/fluent/api/session-id`
- WebSocket: `wss://domain.com/fluent/ws`
- CRM: `https://domain.com/fluent/crm/api/tariffs`
- –°—Ç–∞—Ç–∏–∫–∞: `https://domain.com/fluent/`
